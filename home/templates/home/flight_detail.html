{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight {{ flight.flight_number }} - Out of the Sky</title>
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        .page { max-width: 1200px; margin: 0 auto; padding: 6rem 2rem 2rem; }
        .back-btn { display: inline-block; color: var(--text-light); text-decoration: none; margin-bottom: 1.5rem; }
        .back-btn:hover { color: var(--primary-color); }
        
        .detail-card { background: white; border-radius: 20px; padding: 2rem; box-shadow: var(--shadow-lg); margin-bottom: 2rem; }
        .header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 1.5rem; border-bottom: 2px solid #f3f4f6; margin-bottom: 1.5rem; }
        .title { font-size: 2rem; color: var(--primary-color); margin: 0; }
        .route-text { color: var(--text-light); font-size: 1.1rem; }
        .status { padding: 0.5rem 1.5rem; border-radius: 50px; font-weight: 600; }
        .status-on-time { background: #d1fae5; color: #065f46; }
        .status-delayed { background: #fee2e2; color: #991b1b; }
        
        .route { display: grid; grid-template-columns: 1fr auto 1fr; gap: 2rem; align-items: center; padding: 2rem; background: linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%); border-radius: 15px; margin-bottom: 1.5rem; }
        .airport { text-align: center; }
        .code { font-size: 2.5rem; font-weight: 700; color: var(--text-dark); }
        .city { color: var(--text-light); margin: 0.5rem 0; }
        .plane { font-size: 2.5rem; color: var(--primary-color); animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        
        .times { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
        .time-card { border: 2px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; }
        .time-card:hover { border-color: var(--primary-color); }
        .time-header { font-size: 1.2rem; font-weight: 700; margin-bottom: 1rem; }
        .time-row { display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid #f3f4f6; }
        .time-row:last-child { border-bottom: none; }
        .time-value { color: var(--primary-color); font-weight: 600; }
        
        .info { background: #f8fafc; padding: 1.5rem; border-radius: 12px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .info-item { display: flex; flex-direction: column; gap: 0.25rem; }
        .info-label { font-size: 0.85rem; color: var(--text-light); }
        .info-value { font-weight: 600; color: var(--text-dark); }
        
        .dashboard { margin-top: 3rem; }
        .dashboard h2 { font-size: 1.8rem; margin-bottom: 1.5rem; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat { background: white; padding: 1.5rem; border-radius: 15px; box-shadow: var(--shadow-md); display: flex; align-items: center; gap: 1rem; transition: transform 0.3s; }
        .stat:hover { transform: translateY(-5px); }
        .stat-icon { width: 50px; height: 50px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
        .icon-blue { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); }
        .icon-green { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); }
        .icon-yellow { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); }
        .icon-red { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); }
        .stat-num { font-size: 1.8rem; font-weight: 700; margin: 0; }
        .stat-label { color: var(--text-light); font-size: 0.9rem; }
        
        .flights { display: grid; gap: 1rem; }
        .flight-card { background: white; border: 2px solid #f3f4f6; border-radius: 12px; padding: 1.5rem; text-decoration: none; display: block; transition: all 0.3s; }
        .flight-card:hover { border-color: var(--primary-color); transform: translateY(-3px); box-shadow: var(--shadow-md); }
        .flight-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .flight-num { font-size: 1.2rem; font-weight: 700; color: var(--primary-color); }
        .flight-route { display: flex; justify-content: space-between; align-items: center; }
        .flight-airport { text-align: center; flex: 1; }
        .flight-code { font-size: 1.3rem; font-weight: 700; color: var(--text-dark); }
        .flight-city { font-size: 0.85rem; color: var(--text-light); }
        .arrow { color: var(--primary-color); font-size: 1.3rem; }
        
        @media (max-width: 768px) {
            .header { flex-direction: column; align-items: flex-start; gap: 1rem; }
            .route { grid-template-columns: 1fr; }
            .times { grid-template-columns: 1fr; }
            .stats { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand"><a href="{% url 'home:index' %}"><h2>‚úàÔ∏è Out of the Sky</h2></a></div>
            <ul class="nav-menu">
                <li><a href="{% url 'home:index' %}">Home</a></li>
                <li><a href="{% url 'search:search' %}">Search</a></li>
            </ul>
        </div>
    </nav>

    <div class="page">
        <a href="{% url 'home:index' %}" class="back-btn">‚Üê Back to Home</a>

        <div class="detail-card">
            <div class="header">
                <div>
                    <h1 class="title">Flight {{ flight.flight_number }}</h1>
                    <p class="route-text">{{ flight.departing_city }} ‚Üí {{ flight.arriving_city }}</p>
                </div>
                <div class="status {% if flight.estimated_departure and flight.estimated_departure != flight.scheduled_departure %}status-delayed{% else %}status-on-time{% endif %}">
                    {% if flight.estimated_departure and flight.estimated_departure != flight.scheduled_departure %}Delayed{% else %}On Time{% endif %}
                </div>
            </div>

            <div class="route">
                <div class="airport">
                    <div class="code">{{ flight.departing_city|slice:":3"|upper }}</div>
                    <div class="city">{{ flight.departing_city }}</div>
                </div>
                <div class="plane">‚úà</div>
                <div class="airport">
                    <div class="code">{{ flight.arriving_city|slice:":3"|upper }}</div>
                    <div class="city">{{ flight.arriving_city }}</div>
                </div>
            </div>

            <div class="times">
                <div class="time-card">
                    <div class="time-header">üõ´ Departure</div>
                    <div class="time-row">
                        <span>Scheduled:</span>
                        <span class="time-value">{{ flight.scheduled_departure|date:"M d, g:i A" }}</span>
                    </div>
                    {% if flight.estimated_departure %}
                    <div class="time-row">
                        <span>Estimated:</span>
                        <span class="time-value">{{ flight.estimated_departure|date:"M d, g:i A" }}</span>
                    </div>
                    {% endif %}
                </div>
                <div class="time-card">
                    <div class="time-header">üõ¨ Arrival</div>
                    <div class="time-row">
                        <span>Scheduled:</span>
                        <span class="time-value">{{ flight.scheduled_arrival|date:"M d, g:i A" }}</span>
                    </div>
                    {% if flight.estimated_arrival %}
                    <div class="time-row">
                        <span>Estimated:</span>
                        <span class="time-value">{{ flight.estimated_arrival|date:"M d, g:i A" }}</span>
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="info">
                <div class="info-item">
                    <span class="info-label">Flight Number</span>
                    <span class="info-value">{{ flight.flight_number }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Created</span>
                    <span class="info-value">{{ flight.time_created|date:"M d, Y" }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Last Updated</span>
                    <span class="info-value">{{ flight.last_updated|date:"M d, g:i A" }}</span>
                </div>
            </div>
        </div>

        <div class="dashboard">
            <h2>üìä Flight Dashboard</h2>
            <div class="stats">
                <div class="stat">
                    <div class="stat-icon icon-blue">‚úàÔ∏è</div>
                    <div><p class="stat-num">{{ all_flights.count }}</p><p class="stat-label">Total Flights</p></div>
                </div>
                <div class="stat">
                    <div class="stat-icon icon-green">‚úì</div>
                    <div><p class="stat-num">{{ on_time_count }}</p><p class="stat-label">On Time</p></div>
                </div>
                <div class="stat">
                    <div class="stat-icon icon-yellow">‚è±</div>
                    <div><p class="stat-num">{{ delayed_count }}</p><p class="stat-label">Delayed</p></div>
                </div>
                <div class="stat">
                    <div class="stat-icon icon-red">üìÖ</div>
                    <div><p class="stat-num">{{ upcoming_count }}</p><p class="stat-label">Upcoming</p></div>
                </div>
            </div>

            {% if other_flights %}
            <h3 style="margin-bottom: 1rem;">Other Flights</h3>
            <div class="flights">
                {% for f in other_flights %}
                <a href="{% url 'home:flight_detail' f.id %}" class="flight-card">
                    <div class="flight-header">
                        <div class="flight-num">{{ f.flight_number }}</div>
                        <div class="status {% if f.estimated_departure and f.estimated_departure != f.scheduled_departure %}status-delayed{% else %}status-on-time{% endif %}">
                            {% if f.estimated_departure and f.estimated_departure != f.scheduled_departure %}Delayed{% else %}On Time{% endif %}
                        </div>
                    </div>
                    <div class="flight-route">
                        <div class="flight-airport">
                            <div class="flight-code">{{ f.departing_city|slice:":3"|upper }}</div>
                            <div class="flight-city">{{ f.departing_city }}</div>
                        </div>
                        <div class="arrow">‚Üí</div>
                        <div class="flight-airport">
                            <div class="flight-code">{{ f.arriving_city|slice:":3"|upper }}</div>
                            <div class="flight-city">{{ f.arriving_city }}</div>
                        </div>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</body>
</html>